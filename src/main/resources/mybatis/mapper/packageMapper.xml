<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.tour.hanbando.dao.PackageMapper">
    <!-- 패키지테이블 -->
    <resultMap type="PackageDto" id="PackageMap">
          <id column="PACKAGE_NO" property="packageNo"/>
          <result column="PACKAGE_TITLE" property="packageTitle"/>
          <result column="MINI_ONE" property="miniOne"/>
          <result column="MINI_TWO" property="miniTwo"/>
          <result column="MINI_THREE" property="miniThree"/>
          <result column="PACKAGE_PLAN" property="packagePlan"/>
          <result column="PACKAGE_CONTENTS" property="packageContents"/>
          <result column="HOTEL_CONTENTS" property="hotelContents"/>
          <result column="PRICE" property="price"/>
          <result column="DANGER" property="danger"/>
          <result column="CREATED_AT" property="createdAt"/>
          <result column="MODIFIED_AT" property="modifiedAt"/>
          <result column="HIT" property="hit"/>
          <result column="STATUS" property="status"/>
          <result column="MAX_PEOPLE" property="maxPeople"/>
          <result column="RECOMMEND_STATUS" property="recommendStatus"/>
      <association property="regionDto" javaType="RegionDto">
          <id column="REGION_NO" property="regionNo"/>
          <result column="REGION_NAME" property="regionName"/>
      </association>
      <association property="themeDto" javaType="ThemeDto">
          <id column="THEME_NO" property="themeNo"/>
          <result column="THEME_NAME" property="themeName"/>
      </association>
      <association>
          <id column="IMAGE_NO" property="imageNo"/>
          <result column="PACKAGE_NO" property="packageNo"/>
          <result column="HOTEL_NO" property="hotelNo"/>
          <result column="THUMBNAIL" property="thumbnail"/>
          <result column="FILESYSTEM_NAME" property="filesystemName"/>
          <result column="IMAGE_PATH" property="imagePath"/>
      </association>
      <association property="userDto" javaType="UserDto">
          <id column="USER_NO" property="userNo"/>
          <result column="EMAIL" property="email"/>
          <result column="PW" property="pw"/>
          <result column="NAME" property="name"/>
          <result column="GENDER" property="gender"/>
          <result column="MOBILE" property="mobile"/>
          <result column="POSTCODE" property="postcode"/>
          <result column="ROAD_ADDRESS" property="roadAddress"/>
          <result column="JIBUN_ADDRESS" property="jibunAddress"/>
          <result column="DETAIL_ADDRESS" property="detailAddress"/>
          <result column="AGREE" property="agree"/>
          <result column="STATE" property="state"/>
          <result column="AUTH" property="auth"/>
          <result column="PW_MODIFIED_AT" property="pwModifiedAt"/>
          <result column="JOINED_AT" property="joinedAt"/>
      </association>
    </resultMap>
    <!-- 리뷰테이블 -->
    <resultMap type="ReviewDto" id="ReviewMap">
            <id column="REVIEW_NO" property="reviewNo"/>
            <result column="USER_NO" property="userNo"/>
            <result column="RESERVE_NO" property="reserveNo"/>
            <result column="PACKAGE_NO" property="packageNo"/>
            <result column="HOTEL_NO" property="hotelNo"/>
            <result column="REVIEW_CONTENTS" property="reviewContents"/>
            <result column="STAR" property="star"/>
            <result column="REGIST_AT" property="registAt"/>   
        <association javaType="UserDto" property="userDto">
            <id column="USER_NO" property="userNo"/>
            <result column="EMAIL" property="email"/>
            <result column="PW" property="pw"/>
            <result column="NAME" property="name"/>
            <result column="GENDER" property="gender"/>
            <result column="MOBILE" property="mobile"/>
            <result column="POSTCODE" property="postcode"/>
            <result column="ROAD_ADDRESS" property="roadAddress"/>
            <result column="JIBUN_ADDRESS" property="jibunAddress"/>
            <result column="DETAIL_ADDRESS" property="detailAddress"/>
            <result column="AGREE" property="agree"/>
            <result column="STATE" property="state"/>
            <result column="AUTH" property="auth"/>
            <result column="PW_MODIFIED_AT" property="pwModifiedAt"/>
            <result column="JOINED_AT" property="joinedAt"/>     
        </association>
        <association javaType="PackageDto" property="packageDto">
            <id column="PACKAGE_NO" property="packageNo"/>
            <result column="USER_NO" property="userNo"/>
            <result column="REGION_NO" property="regionNo"/>
            <result column="THEME_NO" property="themeNo"/>
            <result column="PACKAGE_TITLE" property="packageTitle"/>
            <result column="MINI_ONE" property="miniOne"/>
            <result column="MINI_TWO" property="miniTwo"/>
            <result column="MINI_THREE" property="miniThree"/>
            <result column="PACKAGE_PLAN" property="packagePlan"/>
            <result column="PACKAGE_CONTENTS" property="packageContents"/>
            <result column="HOTEL_CONTENTS" property="hotelContents"/>
            <result column="PRICE" property="price"/>
            <result column="DANGER" property="danger"/>
            <result column="CREATED_AT" property="createdAt"/>
            <result column="MODIFIED_AT" property="modifiedAt"/>
            <result column="HIT" property="hit"/>
            <result column="STATUS" property="status"/>
            <result column="MAX_PEOPLE" property="maxPeople"/>
            <result column="RECOMMEND_STATUS" property="recommendStatus"/>       
        </association>
     </resultMap>       

    <!-- 찜테이블 -->
    <resultMap id="HeartDto" type="HeartMap">
            <result column="PACKAGE_NO" property="packageNo"/>
            <result column="HOTEL_NO" property="hotelNo"/>
            <result column="USER_NO" property="userNo"/>
      <association javaType="PackageDto" property="packageDto">
            <id column="PACKAGE_NO" property="packageNo"/>
            <result column="USER_NO" property="userNo"/>
            <result column="REGION_NO" property="regionNo"/>
            <result column="THEME_NO" property="themeNo"/>
            <result column="PACKAGE_TITLE" property="packageTitle"/>
            <result column="MINI_ONE" property="miniOne"/>
            <result column="MINI_TWO" property="miniTwo"/>
            <result column="MINI_THREE" property="miniThree"/>
            <result column="PACKAGE_PLAN" property="packagePlan"/>
            <result column="PACKAGE_CONTENTS" property="packageContents"/>
            <result column="HOTEL_CONTENTS" property="hotelContents"/>
            <result column="PRICE" property="price"/>
            <result column="DANGER" property="danger"/>
            <result column="CREATED_AT" property="createdAt"/>
            <result column="MODIFIED_AT" property="modifiedAt"/>
            <result column="HIT" property="hit"/>
            <result column="STATUS" property="status"/>
            <result column="MAX_PEOPLE" property="maxPeople"/>
            <result column="RECOMMEND_STATUS" property="recommendStatus"/>       
       </association>
    </resultMap>

    <!-- resultMap for PackageMap -->
<resultMap id="PackageMap" type="com.example.dto.PackageDto">
    <id column="PACKAGE_NO" property="packageNo"/>
    <result column="USER_NO" property="userNo"/>
    <result column="REGION_NO" property="regionNo"/>
    <result column="THEME_NO" property="themeNo"/>
    <result column="PACKAGE_TITLE" property="packageTitle"/>
    <result column="MINI_ONE" property="miniOne"/>
    <result column="MINI_TWO" property="miniTwo"/>
    <result column="MINI_THREE" property="miniThree"/>
    <result column="PACKAGE_PLAN" property="packagePlan"/>
    <result column="PACKAGE_CONTENTS" property="packageContents"/>
    <result column="HOTEL_CONTENTS" property="hotelContents"/>
    <result column="PRICE" property="price"/>
    <result column="DANGER" property="danger"/>
    <result column="CREATED_AT" property="createdAt"/>
    <result column="MODIFIED_AT" property="modifiedAt"/>
    <result column="HIT" property="hit"/>
    <result column="STATUS" property="status"/>
    <result column="MAX_PEOPLE" property="maxPeople"/>
    <result column="RECOMMEND_STATUS" property="recommendStatus"/>
    <association property="regionDto" javaType="com.example.dto.RegionDto">
        <id column="REGION_NO" property="regionNo"/>
        <result column="REGION_NAME" property="regionName"/>
    </association>
    <association property="themeDto" javaType="com.example.dto.ThemeDto">
        <id column="THEME_NO" property="themeNo"/>
        <result column="THEME_NAME" property="themeName"/>
    </association>
    <association property="productImageDto" javaType="com.example.dto.ProductImageDto">
        <id column="IMAGE_NO" property="imageNo"/>
        <result column="PACKAGE_NO" property="packageNo"/>
        <result column="HOTEL_NO" property="hotelNo"/>
        <result column="THUMBNAIL" property="thumbnail"/>
        <result column="FILESYSTEM_NAME" property="filesystemName"/>
        <result column="IMAGE_PATH" property="imagePath"/>
    </association>
  </resultMap>

    <!-- SELECT query for joining PACKAGE_T, REGION_T, THEME_T, and PRODUCT_IMAGE_T -->
    <select id="getPackageList" resultMap="PackageMap">
        SELECT
            P.PACKAGE_NO,
            P.USER_NO,
            P.REGION_NO,
            P.THEME_NO,
            P.PACKAGE_TITLE,
            P.MINI_ONE,
            P.MINI_TWO,
            P.MINI_THREE,
            P.PACKAGE_PLAN,
            P.PACKAGE_CONTENTS,
            P.HOTEL_CONTENTS,
            P.PRICE,
            P.DANGER,
            P.CREATED_AT,
            P.MODIFIED_AT,
            P.HIT,
            P.STATUS,
            P.MAX_PEOPLE,
            P.RECOMMEND_STATUS,
            R.REGION_NAME,
            T.THEME_NAME,
            I.IMAGE_NO,
            I.THUMBNAIL,
            I.FILESYSTEM_NAME,
            I.IMAGE_PATH
        FROM PACKAGE_T P
        JOIN REGION_T R ON P.REGION_NO = R.REGION_NO
        JOIN THEME_T T ON P.THEME_NO = T.THEME_NO
        LEFT JOIN PRODUCT_IMAGE_T I ON P.PACKAGE_NO = I.PACKAGE_NO
    </select>



  
</mapper>

